"""Get Tyler's Code to get directions"""

import serial
import time 

arduino = serial.Serial(port='COM4', baudrate=115200, timeout=.1) 
def write_read(x): 
    try:
        arduino.write((x + '\n').encode())
        print(f"Sent '{x}' to Arduino. Waiting for acknowledgment...")

        buffer = ''
        while True:
            if arduino.in_waiting:
                byte = ser.read().decode('utf-8', errors='ignore')
                if byte in ['\n', '\r']:
                    if buffer.strip() == "Recieved":
                        print("Arduino acknowledged: Recieved âœ…")
                        break
                    buffer = ''  # Reset buffer
                else:
                    buffer += byte

        arduino.close()

    except serial.SerialException as e:
        print(f"Serial error: {e}")
    except Exception as e:
        print(f"Unexpected error: {e}")
	
#send cm needed to travel
cmd = ''
while True: 
	
    num = (input("Enter a cmd (Options are 2, S, I, M, D): "))
    num = num[0]
    write_read(num) 
        # Wait until Arduino sends a non-empty message back
    match num:
        case 'S': #spin to angle
            heading = int(input("Enter a heading in degrees: "))# Taking input from user
            write_read(heading)
            break
        case 'I': #spin infinitely
            input("Press Enter to stop spinning and continue...")
            break
        case 'M': #move forward infinitely
            flag = False
            inp = ''
            while not flag:
                inp = input("Enter char when you want to stop spinning: ")
                if inp != '':
                    flag = True
            break
        case '2': #flight path 2 (move forward then move down)
        case 'D': #fly in place
            
               
            
            if response:
                print("Arduino says:", response.decode().strip())



